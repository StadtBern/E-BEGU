{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/admin/component/parameterView/parameterView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/parameterView/parameterView.ts","mtime":1518612532786},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["\"use strict\";\n/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./parameterView.less\");\nvar abstractAdminView_1 = require(\"../../abstractAdminView\");\nvar template = require('./parameterView.html');\nvar style = require('./parameterView.less');\nvar ParameterViewComponentConfig = /** @class */ (function () {\n    function ParameterViewComponentConfig() {\n        this.transclude = false;\n        this.template = template;\n        this.controller = ParameterViewController;\n        this.controllerAs = 'vm';\n    }\n    return ParameterViewComponentConfig;\n}());\nexports.ParameterViewComponentConfig = ParameterViewComponentConfig;\nvar ParameterViewController = /** @class */ (function (_super) {\n    __extends(ParameterViewController, _super);\n    /* @ngInject */\n    function ParameterViewController(ebeguParameterRS, gesuchsperiodeRS, $translate, $log, $state, $timeout, authServiceRS) {\n        var _this = _super.call(this, authServiceRS) || this;\n        _this.gesuchsperiodeRS = gesuchsperiodeRS;\n        _this.$translate = $translate;\n        _this.$log = $log;\n        _this.$state = $state;\n        _this.$timeout = $timeout;\n        _this.gesuchsperiodenList = [];\n        _this.ebeguJahresabhParameter = []; // enthält alle Jahresabhängigen Params für alle Jahre\n        _this.ebeguParameterRS = ebeguParameterRS;\n        $timeout(function () {\n            _this.readGesuchsperioden();\n            _this.updateJahresabhParamList();\n        });\n        return _this;\n    }\n    ParameterViewController.prototype.readGesuchsperioden = function () {\n        var _this = this;\n        this.gesuchsperiodeRS.getAllGesuchsperioden().then(function (response) {\n            _this.gesuchsperiodenList = response; //angular.copy(response);\n        });\n    };\n    ParameterViewController.prototype.readEbeguParameterByJahr = function () {\n        var _this = this;\n        this.ebeguParameterRS.getEbeguParameterByJahr(this.jahr).then(function (response) {\n            _this.ebeguParameterListJahr = response;\n        });\n    };\n    ParameterViewController.prototype.gesuchsperiodeClicked = function (gesuchsperiode) {\n        if (gesuchsperiode.isSelected) {\n            this.$state.go('gesuchsperiode', {\n                gesuchsperiodeId: gesuchsperiode.id\n            });\n        }\n    };\n    ParameterViewController.prototype.jahresabhParamSelected = function (parameter) {\n        this.jahr = parameter.gueltigkeit.gueltigAb.get('year');\n        this.jahrChanged();\n    };\n    ParameterViewController.prototype.createGesuchsperiode = function () {\n        this.$state.go('gesuchsperiode', {\n            gesuchsperiodeId: undefined\n        });\n    };\n    ParameterViewController.prototype.getStatusTagesschulenFreischaltung = function (gp) {\n        if (gp.hasTagesschulenAnmeldung()) {\n            if (gp.isTagesschulenAnmeldungKonfiguriert()) {\n                return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_KONFIGURIERT');\n            }\n            else {\n                return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_NOT_YET');\n            }\n        }\n        else {\n            return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_NONE');\n        }\n    };\n    ParameterViewController.prototype.cancelJahresabhaengig = function () {\n        this.jahr = undefined;\n    };\n    ParameterViewController.prototype.jahrChanged = function () {\n        this.readEbeguParameterByJahr();\n    };\n    ParameterViewController.prototype.saveParameterByJahr = function () {\n        var _this = this;\n        if (this.ebeguParameterListJahr.length === 1) {\n            var param = this.ebeguParameterListJahr[0];\n            this.ebeguParameterRS.saveEbeguParameter(param).then(function (response) {\n                _this.updateJahresabhParamList();\n            });\n        }\n        else {\n            this.$log.error('Aktuell kann diese oberflaeche nur einene einzelnen Jahresabg. Param speichern.');\n        }\n    };\n    ParameterViewController.prototype.updateJahresabhParamList = function () {\n        var _this = this;\n        this.ebeguParameterRS.getJahresabhParameter().then(function (response) {\n            _this.ebeguJahresabhParameter = response;\n        });\n    };\n    ParameterViewController.prototype.jahresParamsEditable = function () {\n        // Wenn die Periode, die in dem Jahr *endet* noch ENTWURF ist\n        for (var _i = 0, _a = this.gesuchsperiodenList; _i < _a.length; _i++) {\n            var gp = _a[_i];\n            if (gp.gueltigkeit.gueltigBis.year() === this.jahr) {\n                return this.periodenParamsEditableForPeriode(gp);\n            }\n        }\n        return true;\n    };\n    ParameterViewController.$inject = ['EbeguParameterRS', 'GesuchsperiodeRS', '$translate',\n        '$log', '$state', '$timeout', 'AuthServiceRS'];\n    return ParameterViewController;\n}(abstractAdminView_1.default));\nexports.ParameterViewController = ParameterViewController;\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/parameterView/parameterView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/admin/component/parameterView/parameterView.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport TSEbeguParameter from '../../../models/TSEbeguParameter';\nimport {EbeguParameterRS} from '../../service/ebeguParameterRS.rest';\nimport {IComponentOptions, IFormController, ILogService} from 'angular';\nimport './parameterView.less';\nimport TSGesuchsperiode from '../../../models/TSGesuchsperiode';\nimport GesuchsperiodeRS from '../../../core/service/gesuchsperiodeRS.rest';\nimport AbstractAdminViewController from '../../abstractAdminView';\nimport AuthServiceRS from '../../../authentication/service/AuthServiceRS.rest';\nimport ITranslateService = angular.translate.ITranslateService;\nimport ITimeoutService = angular.ITimeoutService;\nimport IStateService = angular.ui.IStateService;\n\nlet template = require('./parameterView.html');\nlet style = require('./parameterView.less');\n\nexport class ParameterViewComponentConfig implements IComponentOptions {\n    transclude: boolean = false;\n    template: string = template;\n    controller: any = ParameterViewController;\n    controllerAs: string = 'vm';\n}\n\nexport class ParameterViewController extends AbstractAdminViewController {\n    static $inject = ['EbeguParameterRS', 'GesuchsperiodeRS', '$translate',\n        '$log', '$state', '$timeout', 'AuthServiceRS'];\n\n    form: IFormController;\n\n    ebeguParameterRS: EbeguParameterRS;\n\n    gesuchsperiodenList: Array<TSGesuchsperiode> = [];\n\n    jahr: number;\n    ebeguJahresabhParameter: TSEbeguParameter[] = []; // enthält alle Jahresabhängigen Params für alle Jahre\n\n    ebeguParameterListJahr: TSEbeguParameter[]; // enthält alle Params für nur 1 Jahr\n\n\n    /* @ngInject */\n    constructor(ebeguParameterRS: EbeguParameterRS, private gesuchsperiodeRS: GesuchsperiodeRS,\n                private $translate: ITranslateService, private $log: ILogService, private $state: IStateService,\n                private $timeout: ITimeoutService, authServiceRS: AuthServiceRS) {\n        super(authServiceRS);\n        this.ebeguParameterRS = ebeguParameterRS;\n        $timeout(() => {\n            this.readGesuchsperioden();\n            this.updateJahresabhParamList();\n        });\n    }\n\n    private readGesuchsperioden(): void {\n        this.gesuchsperiodeRS.getAllGesuchsperioden().then((response: Array<TSGesuchsperiode>) => {\n            this.gesuchsperiodenList =  response; //angular.copy(response);\n        });\n    }\n\n    private readEbeguParameterByJahr(): void {\n        this.ebeguParameterRS.getEbeguParameterByJahr(this.jahr).then((response: TSEbeguParameter[]) => {\n            this.ebeguParameterListJahr = response;\n        });\n    }\n\n    gesuchsperiodeClicked(gesuchsperiode: any) {\n        if (gesuchsperiode.isSelected) {\n            this.$state.go('gesuchsperiode', {\n                gesuchsperiodeId: gesuchsperiode.id\n            });\n        }\n    }\n\n    jahresabhParamSelected(parameter: TSEbeguParameter) {\n        this.jahr = parameter.gueltigkeit.gueltigAb.get('year');\n        this.jahrChanged();\n    }\n\n    createGesuchsperiode(): void {\n        this.$state.go('gesuchsperiode', {\n            gesuchsperiodeId: undefined\n        });\n    }\n\n    getStatusTagesschulenFreischaltung(gp: TSGesuchsperiode): string {\n        if (gp.hasTagesschulenAnmeldung()) {\n            if (gp.isTagesschulenAnmeldungKonfiguriert()) {\n                return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_KONFIGURIERT');\n            } else {\n                return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_NOT_YET');\n            }\n        } else {\n            return this.$translate.instant('FREISCHALTUNG_TAGESSCHULE_NONE');\n        }\n    }\n\n    cancelJahresabhaengig(): void {\n        this.jahr = undefined;\n    }\n\n    jahrChanged(): void {\n        this.readEbeguParameterByJahr();\n    }\n\n    public saveParameterByJahr(): void {\n        if (this.ebeguParameterListJahr.length === 1) {\n            let param = this.ebeguParameterListJahr[0];\n            this.ebeguParameterRS.saveEbeguParameter(param).then((response) => {\n                this.updateJahresabhParamList();\n            });\n        } else {\n            this.$log.error('Aktuell kann diese oberflaeche nur einene einzelnen Jahresabg. Param speichern.');\n        }\n    }\n\n    private updateJahresabhParamList() {\n        this.ebeguParameterRS.getJahresabhParameter().then((response: Array<TSEbeguParameter>) => {\n            this.ebeguJahresabhParameter = response;\n        });\n    }\n\n    public jahresParamsEditable(): boolean {\n        // Wenn die Periode, die in dem Jahr *endet* noch ENTWURF ist\n        for (let gp of this.gesuchsperiodenList) {\n            if (gp.gueltigkeit.gueltigBis.year() === this.jahr) {\n                return this.periodenParamsEditableForPeriode(gp);\n            }\n        }\n        return true;\n    }\n}\n"]}]}