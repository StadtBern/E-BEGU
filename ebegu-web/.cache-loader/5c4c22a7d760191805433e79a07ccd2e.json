{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/gesuch/component/abstractGesuchView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/gesuch/component/abstractGesuchView.ts","mtime":1513352936272},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["\"use strict\";\n/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TSRole_1 = require(\"../../models/enums/TSRole\");\nvar TSRoleUtil_1 = require(\"../../utils/TSRoleUtil\");\nvar TSErrorEvent_1 = require(\"../../models/enums/TSErrorEvent\");\nvar EbeguUtil_1 = require(\"../../utils/EbeguUtil\");\nvar AbstractGesuchViewController = /** @class */ (function () {\n    function AbstractGesuchViewController($gesuchModelManager, $berechnungsManager, wizardStepManager, $scope, stepName, $timeout) {\n        this.gesuchModelManager = $gesuchModelManager;\n        this.berechnungsManager = $berechnungsManager;\n        this.wizardStepManager = wizardStepManager;\n        this.TSRole = TSRole_1.TSRole;\n        this.TSRoleUtil = TSRoleUtil_1.TSRoleUtil;\n        this.$scope = $scope;\n        this.$timeout = $timeout;\n        this.wizardStepManager.setCurrentStep(stepName);\n    }\n    AbstractGesuchViewController.prototype.$onInit = function () {\n        var _this = this;\n        /**\n         * Grund fuer diesen Code ist:\n         * Wenn der Server einen Validation-Fehler zurueckgibt, wird der DirtyPlugin nicht informiert und setzt das Form\n         * auf !dirty. Dann kann der Benutzer nochmal auf Speichern klicken und die Daten werden gespeichert.\n         * Damit dies nicht passiert, hoeren wir in allen Views auf diesen Event und setzen das Form auf dirty\n         */\n        this.$scope.$on(TSErrorEvent_1.TSMessageEvent[TSErrorEvent_1.TSMessageEvent.ERROR_UPDATE], function (event, errors) {\n            _this.form.$dirty = true;\n            _this.form.$pristine = false;\n        });\n    };\n    AbstractGesuchViewController.prototype.isGesuchReadonly = function () {\n        return this.gesuchModelManager.isGesuchReadonly();\n    };\n    /**\n     * Diese Methode prueft ob das Form valid ist. Sollte es nicht valid sein wird das erste fehlende Element gesucht\n     * und fokusiert, damit der Benutzer nicht scrollen muss, um den Fehler zu finden.\n     * Am Ende wird this.form.$valid zurueckgegeben\n     */\n    AbstractGesuchViewController.prototype.isGesuchValid = function () {\n        if (!this.form.$valid) {\n            EbeguUtil_1.default.selectFirstInvalid();\n        }\n        return this.form.$valid;\n    };\n    AbstractGesuchViewController.prototype.getGesuchId = function () {\n        if (this.gesuchModelManager && this.gesuchModelManager.getGesuch()) {\n            return this.gesuchModelManager.getGesuch().id;\n        }\n        else {\n            return '';\n        }\n    };\n    AbstractGesuchViewController.prototype.setGesuchStatus = function (status) {\n        if (this.gesuchModelManager) {\n            return this.gesuchModelManager.saveGesuchStatus(status);\n        }\n        return undefined;\n    };\n    AbstractGesuchViewController.prototype.isGesuchInStatus = function (status) {\n        return status === this.gesuchModelManager.getGesuch().status;\n    };\n    AbstractGesuchViewController.prototype.isBetreuungInStatus = function (status) {\n        if (this.gesuchModelManager.getBetreuungToWorkWith()) {\n            return status === this.gesuchModelManager.getBetreuungToWorkWith().betreuungsstatus;\n        }\n        return false;\n    };\n    AbstractGesuchViewController.prototype.isMutation = function () {\n        if (this.gesuchModelManager.getGesuch()) {\n            return this.gesuchModelManager.getGesuch().isMutation();\n        }\n        return false;\n    };\n    AbstractGesuchViewController.prototype.isKorrekturModusJugendamt = function () {\n        return this.gesuchModelManager.isKorrekturModusJugendamt();\n    };\n    Object.defineProperty(AbstractGesuchViewController.prototype, \"model\", {\n        get: function () {\n            return this._model;\n        },\n        set: function (value) {\n            this._model = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AbstractGesuchViewController.prototype.extractFullNameGS1 = function () {\n        if (this.gesuchModelManager.getGesuch() && this.gesuchModelManager.getGesuch().gesuchsteller1) {\n            return this.gesuchModelManager.getGesuch().gesuchsteller1.extractFullName();\n        }\n        return '';\n    };\n    AbstractGesuchViewController.prototype.extractFullNameGS2 = function () {\n        if (this.gesuchModelManager.getGesuch() && this.gesuchModelManager.getGesuch().gesuchsteller2) {\n            return this.gesuchModelManager.getGesuch().gesuchsteller2.extractFullName();\n        }\n        return '';\n    };\n    AbstractGesuchViewController.prototype.$postLink = function () {\n        this.$timeout(function () {\n            EbeguUtil_1.default.selectFirst();\n        }, 200);\n    };\n    return AbstractGesuchViewController;\n}());\nexports.default = AbstractGesuchViewController;\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/gesuch/component/abstractGesuchView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/gesuch/component/abstractGesuchView.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport GesuchModelManager from '../service/gesuchModelManager';\nimport BerechnungsManager from '../service/berechnungsManager';\nimport {TSRole} from '../../models/enums/TSRole';\nimport {TSRoleUtil} from '../../utils/TSRoleUtil';\nimport WizardStepManager from '../service/wizardStepManager';\nimport {TSAntragStatus} from '../../models/enums/TSAntragStatus';\nimport {TSBetreuungsstatus} from '../../models/enums/TSBetreuungsstatus';\nimport TSExceptionReport from '../../models/TSExceptionReport';\nimport {TSMessageEvent} from '../../models/enums/TSErrorEvent';\nimport {TSWizardStepName} from '../../models/enums/TSWizardStepName';\nimport EbeguUtil from '../../utils/EbeguUtil';\nimport IPromise = angular.IPromise;\nimport IFormController = angular.IFormController;\nimport IScope = angular.IScope;\nimport ITimeoutService = angular.ITimeoutService;\n\nexport default class AbstractGesuchViewController<T> {\n\n    $scope: IScope;\n    gesuchModelManager: GesuchModelManager;\n    berechnungsManager: BerechnungsManager;\n    wizardStepManager: WizardStepManager;\n    TSRole: any;\n    TSRoleUtil: any;\n    private _model: T;\n    form: IFormController;\n    $timeout: ITimeoutService;\n\n    constructor($gesuchModelManager: GesuchModelManager, $berechnungsManager: BerechnungsManager,\n                wizardStepManager: WizardStepManager, $scope: IScope, stepName: TSWizardStepName,\n                $timeout: ITimeoutService) {\n        this.gesuchModelManager = $gesuchModelManager;\n        this.berechnungsManager = $berechnungsManager;\n        this.wizardStepManager = wizardStepManager;\n        this.TSRole = TSRole;\n        this.TSRoleUtil = TSRoleUtil;\n        this.$scope = $scope;\n        this.$timeout = $timeout;\n        this.wizardStepManager.setCurrentStep(stepName);\n    }\n\n    $onInit() {\n        /**\n         * Grund fuer diesen Code ist:\n         * Wenn der Server einen Validation-Fehler zurueckgibt, wird der DirtyPlugin nicht informiert und setzt das Form\n         * auf !dirty. Dann kann der Benutzer nochmal auf Speichern klicken und die Daten werden gespeichert.\n         * Damit dies nicht passiert, hoeren wir in allen Views auf diesen Event und setzen das Form auf dirty\n         */\n        this.$scope.$on(TSMessageEvent[TSMessageEvent.ERROR_UPDATE], (event: any, errors: Array<TSExceptionReport>) => {\n            this.form.$dirty = true;\n            this.form.$pristine = false;\n        });\n    }\n\n    public isGesuchReadonly(): boolean {\n        return this.gesuchModelManager.isGesuchReadonly();\n    }\n\n    /**\n     * Diese Methode prueft ob das Form valid ist. Sollte es nicht valid sein wird das erste fehlende Element gesucht\n     * und fokusiert, damit der Benutzer nicht scrollen muss, um den Fehler zu finden.\n     * Am Ende wird this.form.$valid zurueckgegeben\n     */\n    public isGesuchValid(): boolean {\n        if (!this.form.$valid) {\n           EbeguUtil.selectFirstInvalid();\n        }\n        return this.form.$valid;\n    }\n\n    public getGesuchId(): string {\n        if (this.gesuchModelManager && this.gesuchModelManager.getGesuch()) {\n            return this.gesuchModelManager.getGesuch().id;\n        } else {\n            return '';\n        }\n    }\n\n    public setGesuchStatus(status: TSAntragStatus): IPromise<TSAntragStatus> {\n        if (this.gesuchModelManager) {\n            return this.gesuchModelManager.saveGesuchStatus(status);\n        }\n        return undefined;\n    }\n\n    public isGesuchInStatus(status: TSAntragStatus): boolean {\n        return status === this.gesuchModelManager.getGesuch().status;\n    }\n\n    public isBetreuungInStatus(status: TSBetreuungsstatus): boolean {\n        if (this.gesuchModelManager.getBetreuungToWorkWith()) {\n            return status === this.gesuchModelManager.getBetreuungToWorkWith().betreuungsstatus;\n        }\n        return false;\n    }\n\n    public isMutation(): boolean {\n        if (this.gesuchModelManager.getGesuch()) {\n            return this.gesuchModelManager.getGesuch().isMutation();\n        }\n        return false;\n    }\n\n    public isKorrekturModusJugendamt(): boolean {\n        return this.gesuchModelManager.isKorrekturModusJugendamt();\n    }\n\n    get model(): T {\n        return this._model;\n    }\n\n    set model(value: T) {\n        this._model = value;\n    }\n\n    public extractFullNameGS1(): string {\n        if (this.gesuchModelManager.getGesuch() && this.gesuchModelManager.getGesuch().gesuchsteller1) {\n            return this.gesuchModelManager.getGesuch().gesuchsteller1.extractFullName();\n        }\n        return '';\n    }\n\n    public extractFullNameGS2(): string {\n        if (this.gesuchModelManager.getGesuch() && this.gesuchModelManager.getGesuch().gesuchsteller2) {\n            return this.gesuchModelManager.getGesuch().gesuchsteller2.extractFullName();\n        }\n        return '';\n    }\n\n    $postLink() {\n        this.$timeout(() => {\n            EbeguUtil.selectFirst();\n        }, 200);\n    }\n}\n"]}]}