{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/zahlung/component/zahlungView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/zahlung/component/zahlungView.ts","mtime":1512484412031},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["\"use strict\";\n/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TSRole_1 = require(\"../../models/enums/TSRole\");\nvar EbeguUtil_1 = require(\"../../utils/EbeguUtil\");\nvar TSZahlungsstatus_1 = require(\"../../models/enums/TSZahlungsstatus\");\nvar template = require('./zahlungView.html');\nrequire('./zahlungView.less');\nvar ZahlungViewComponentConfig = /** @class */ (function () {\n    function ZahlungViewComponentConfig() {\n        this.transclude = false;\n        this.template = template;\n        this.controller = ZahlungViewController;\n        this.controllerAs = 'vm';\n    }\n    return ZahlungViewComponentConfig;\n}());\nexports.ZahlungViewComponentConfig = ZahlungViewComponentConfig;\nvar ZahlungViewController = /** @class */ (function () {\n    function ZahlungViewController(zahlungRS, CONSTANTS, $stateParams, $state, downloadRS, reportRS, authServiceRS, ebeguUtil) {\n        this.zahlungRS = zahlungRS;\n        this.CONSTANTS = CONSTANTS;\n        this.$stateParams = $stateParams;\n        this.$state = $state;\n        this.downloadRS = downloadRS;\n        this.reportRS = reportRS;\n        this.authServiceRS = authServiceRS;\n        this.ebeguUtil = ebeguUtil;\n        this.itemsByPage = 20;\n        this.initViewModel();\n    }\n    ZahlungViewController.prototype.initViewModel = function () {\n        var _this = this;\n        if (this.$stateParams.zahlungsauftragId) {\n            switch (this.authServiceRS.getPrincipal().role) {\n                case TSRole_1.TSRole.SACHBEARBEITER_INSTITUTION:\n                case TSRole_1.TSRole.SACHBEARBEITER_TRAEGERSCHAFT: {\n                    this.zahlungRS.getZahlungsauftragInstitution(this.$stateParams.zahlungsauftragId).then(function (response) {\n                        _this.zahlungen = response.zahlungen;\n                    });\n                    break;\n                }\n                case TSRole_1.TSRole.SUPER_ADMIN:\n                case TSRole_1.TSRole.ADMIN:\n                case TSRole_1.TSRole.SACHBEARBEITER_JA:\n                case TSRole_1.TSRole.JURIST:\n                case TSRole_1.TSRole.REVISOR: {\n                    this.zahlungRS.getZahlungsauftrag(this.$stateParams.zahlungsauftragId).then(function (response) {\n                        _this.zahlungen = response.zahlungen;\n                    });\n                    break;\n                }\n                default:\n                    break;\n            }\n        }\n    };\n    ZahlungViewController.prototype.gotToUebersicht = function () {\n        this.$state.go('zahlungsauftrag');\n    };\n    ZahlungViewController.prototype.downloadDetails = function (zahlung) {\n        var _this = this;\n        var win = this.downloadRS.prepareDownloadWindow();\n        this.reportRS.getZahlungReportExcel(zahlung.id)\n            .then(function (downloadFile) {\n            _this.downloadRS.startDownload(downloadFile.accessToken, downloadFile.filename, false, win);\n        })\n            .catch(function (ex) {\n            win.close();\n        });\n    };\n    ZahlungViewController.prototype.bestaetigen = function (zahlung) {\n        var _this = this;\n        console.log('bestaetigen');\n        this.zahlungRS.zahlungBestaetigen(zahlung.id).then(function (response) {\n            var index = EbeguUtil_1.default.getIndexOfElementwithID(response, _this.zahlungen);\n            if (index > -1) {\n                _this.zahlungen[index] = response;\n            }\n            _this.ebeguUtil.handleSmarttablesUpdateBug(_this.zahlungen);\n        });\n    };\n    ZahlungViewController.prototype.isBestaetigt = function (zahlungstatus) {\n        return zahlungstatus === TSZahlungsstatus_1.TSZahlungsstatus.BESTAETIGT;\n    };\n    ZahlungViewController.$inject = ['ZahlungRS', 'CONSTANTS', '$stateParams', '$state', 'DownloadRS', 'ReportRS',\n        'AuthServiceRS', 'EbeguUtil'];\n    return ZahlungViewController;\n}());\nexports.ZahlungViewController = ZahlungViewController;\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/zahlung/component/zahlungView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/zahlung/component/zahlungView.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {IComponentOptions} from 'angular';\nimport TSZahlung from '../../models/TSZahlung';\nimport ZahlungRS from '../../core/service/zahlungRS.rest';\nimport {IZahlungsauftragStateParams} from '../zahlung.route';\nimport {DownloadRS} from '../../core/service/downloadRS.rest';\nimport {ReportRS} from '../../core/service/reportRS.rest';\nimport TSDownloadFile from '../../models/TSDownloadFile';\nimport {TSRole} from '../../models/enums/TSRole';\nimport AuthServiceRS from '../../authentication/service/AuthServiceRS.rest';\nimport EbeguUtil from '../../utils/EbeguUtil';\nimport {TSZahlungsstatus} from '../../models/enums/TSZahlungsstatus';\nimport IStateService = angular.ui.IStateService;\nlet template = require('./zahlungView.html');\nrequire('./zahlungView.less');\n\nexport class ZahlungViewComponentConfig implements IComponentOptions {\n    transclude = false;\n    template = template;\n    controller = ZahlungViewController;\n    controllerAs = 'vm';\n}\n\nexport class ZahlungViewController {\n\n    private zahlungen: Array<TSZahlung>;\n\n    itemsByPage: number = 20;\n\n    static $inject: string[] = ['ZahlungRS', 'CONSTANTS', '$stateParams', '$state', 'DownloadRS', 'ReportRS',\n        'AuthServiceRS', 'EbeguUtil'];\n\n    constructor(private zahlungRS: ZahlungRS, private CONSTANTS: any,\n                private $stateParams: IZahlungsauftragStateParams, private $state: IStateService,\n                private downloadRS: DownloadRS, private reportRS: ReportRS, private authServiceRS: AuthServiceRS,\n                private ebeguUtil: EbeguUtil) {\n        this.initViewModel();\n    }\n\n    private initViewModel() {\n        if (this.$stateParams.zahlungsauftragId) {\n            switch (this.authServiceRS.getPrincipal().role) {\n                case TSRole.SACHBEARBEITER_INSTITUTION:\n                case TSRole.SACHBEARBEITER_TRAEGERSCHAFT: {\n                    this.zahlungRS.getZahlungsauftragInstitution(this.$stateParams.zahlungsauftragId).then((response) => {\n                        this.zahlungen = response.zahlungen;\n                    });\n                    break;\n                }\n                case TSRole.SUPER_ADMIN:\n                case TSRole.ADMIN:\n                case TSRole.SACHBEARBEITER_JA:\n                case TSRole.JURIST:\n                case TSRole.REVISOR: {\n                    this.zahlungRS.getZahlungsauftrag(this.$stateParams.zahlungsauftragId).then((response) => {\n                        this.zahlungen = response.zahlungen;\n                    });\n                    break;\n                }\n                default:\n                    break;\n            }\n        }\n    }\n\n    private gotToUebersicht(): void {\n        this.$state.go('zahlungsauftrag');\n    }\n\n    public downloadDetails(zahlung: TSZahlung) {\n        let win: Window = this.downloadRS.prepareDownloadWindow();\n        this.reportRS.getZahlungReportExcel(zahlung.id)\n            .then((downloadFile: TSDownloadFile) => {\n                this.downloadRS.startDownload(downloadFile.accessToken, downloadFile.filename, false, win);\n            })\n            .catch((ex) => {\n                win.close();\n            });\n    }\n\n    public bestaetigen(zahlung: TSZahlung) {\n        console.log('bestaetigen');\n        this.zahlungRS.zahlungBestaetigen(zahlung.id).then((response: TSZahlung) => {\n            let index = EbeguUtil.getIndexOfElementwithID(response, this.zahlungen);\n            if (index > -1) {\n                this.zahlungen[index] = response;\n            }\n            this.ebeguUtil.handleSmarttablesUpdateBug(this.zahlungen);\n        });\n    }\n\n    public isBestaetigt(zahlungstatus: TSZahlungsstatus): boolean {\n        return zahlungstatus === TSZahlungsstatus.BESTAETIGT;\n    }\n}\n"]}]}