{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/posteingang/component/posteingangView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/posteingang/component/posteingangView.ts","mtime":1518612532818},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["\"use strict\";\n/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TSAmt_1 = require(\"../../models/enums/TSAmt\");\nvar TSMitteilungStatus_1 = require(\"../../models/enums/TSMitteilungStatus\");\nvar TSRoleUtil_1 = require(\"../../utils/TSRoleUtil\");\nvar template = require('./posteingangView.html');\nrequire('./posteingangView.less');\nvar PosteingangViewComponentConfig = /** @class */ (function () {\n    function PosteingangViewComponentConfig() {\n        this.transclude = false;\n        this.template = template;\n        this.controller = PosteingangViewController;\n        this.controllerAs = 'vm';\n    }\n    return PosteingangViewComponentConfig;\n}());\nexports.PosteingangViewComponentConfig = PosteingangViewComponentConfig;\nvar PosteingangViewController = /** @class */ (function () {\n    function PosteingangViewController(mitteilungRS, ebeguUtil, CONSTANTS, $state, authServiceRS, $log) {\n        var _this = this;\n        this.mitteilungRS = mitteilungRS;\n        this.ebeguUtil = ebeguUtil;\n        this.CONSTANTS = CONSTANTS;\n        this.$state = $state;\n        this.authServiceRS = authServiceRS;\n        this.$log = $log;\n        this.displayedCollection = []; //Liste die im Gui angezeigt wird\n        this.pagination = {};\n        this.totalResultCount = '0';\n        this.itemsByPage = 20;\n        this.numberOfPages = 1;\n        this.passFilterToServer = function (tableFilterState) {\n            _this.pagination = tableFilterState.pagination;\n            _this.myTableFilterState = tableFilterState;\n            return _this.mitteilungRS.searchMitteilungen(tableFilterState, _this.includeClosed).then(function (result) {\n                _this.setResult(result);\n            });\n        };\n    }\n    PosteingangViewController.prototype.addZerosToFallNummer = function (fallnummer) {\n        return this.ebeguUtil.addZerosToNumber(fallnummer, this.CONSTANTS.FALLNUMMER_LENGTH);\n    };\n    PosteingangViewController.prototype.gotoMitteilung = function (mitteilung) {\n        this.$state.go('mitteilungen', {\n            fallId: mitteilung.fall.id\n        });\n    };\n    PosteingangViewController.prototype.isCurrentUserSchulamt = function () {\n        var isUserSchulamt = this.authServiceRS.isOneOfRoles(TSRoleUtil_1.TSRoleUtil.getSchulamtOnlyRoles());\n        return isUserSchulamt;\n    };\n    PosteingangViewController.prototype.getAemter = function () {\n        return TSAmt_1.getAemterForFilter();\n    };\n    PosteingangViewController.prototype.getMitteilungsStatus = function () {\n        return TSMitteilungStatus_1.getTSMitteilungsStatusForFilter();\n    };\n    PosteingangViewController.prototype.clickedIncludeClosed = function () {\n        this.passFilterToServer(this.myTableFilterState);\n    };\n    PosteingangViewController.prototype.setResult = function (result) {\n        if (result) {\n            this.pagination.totalItemCount = result.totalResultSize;\n            this.pagination.numberOfPages = Math.ceil(result.totalResultSize / this.pagination.number);\n            this.displayedCollection = [].concat(result.mitteilungen);\n            this.totalResultCount = result.totalResultSize ? result.totalResultSize.toString() : '0';\n        }\n    };\n    PosteingangViewController.$inject = ['MitteilungRS', 'EbeguUtil', 'CONSTANTS', '$state', 'AuthServiceRS', '$log'];\n    return PosteingangViewController;\n}());\nexports.PosteingangViewController = PosteingangViewController;\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/posteingang/component/posteingangView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/posteingang/component/posteingangView.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;GAaG;;AAKH,kDAAmE;AACnE,4EAA0G;AAI1G,qDAAkD;AAElD,IAAI,QAAQ,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AACjD,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAElC;IAAA;QACI,eAAU,GAAG,KAAK,CAAC;QACnB,aAAQ,GAAG,QAAQ,CAAC;QACpB,eAAU,GAAG,yBAAyB,CAAC;QACvC,iBAAY,GAAG,IAAI,CAAC;IACxB,CAAC;IAAD,qCAAC;AAAD,CAAC,AALD,IAKC;AALY,wEAA8B;AAO3C;IAiBI,mCAAoB,YAA0B,EAAU,SAAoB,EAAU,SAAc,EAAU,MAAqB,EAC/G,aAA4B,EAAU,IAAiB;QAD3E,iBAEC;QAFmB,iBAAY,GAAZ,YAAY,CAAc;QAAU,cAAS,GAAT,SAAS,CAAW;QAAU,cAAS,GAAT,SAAS,CAAK;QAAU,WAAM,GAAN,MAAM,CAAe;QAC/G,kBAAa,GAAb,aAAa,CAAe;QAAU,SAAI,GAAJ,IAAI,CAAa;QAhB3E,wBAAmB,GAAwB,EAAE,CAAC,CAAC,iCAAiC;QAChF,eAAU,GAAQ,EAAE,CAAC;QACrB,qBAAgB,GAAW,GAAG,CAAC;QAG/B,gBAAW,GAAW,EAAE,CAAC;QACzB,kBAAa,GAAW,CAAC,CAAC;QAwCnB,uBAAkB,GAAG,UAAC,gBAAqB;YAC9C,KAAI,CAAC,UAAU,GAAG,gBAAgB,CAAC,UAAU,CAAC;YAC9C,KAAI,CAAC,kBAAkB,GAAG,gBAAgB,CAAC;YAE3C,MAAM,CAAC,KAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,KAAI,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,UAAC,MAAkC;gBACtH,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAC3B,CAAC,CAAC,CAAC;QACP,CAAC,CAAA;IApCD,CAAC;IAEM,wDAAoB,GAA3B,UAA4B,UAAkB;QAC1C,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;IACzF,CAAC;IAEO,kDAAc,GAAtB,UAAuB,UAAwB;QAC3C,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,cAAc,EAAE;YAC3B,MAAM,EAAE,UAAU,CAAC,IAAI,CAAC,EAAE;SAC7B,CAAC,CAAC;IACP,CAAC;IAED,yDAAqB,GAArB;QACI,IAAI,cAAc,GAAY,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,uBAAU,CAAC,oBAAoB,EAAE,CAAC,CAAC;QACjG,MAAM,CAAC,cAAc,CAAC;IAC1B,CAAC;IAED,6CAAS,GAAT;QACI,MAAM,CAAC,0BAAkB,EAAE,CAAC;IAChC,CAAC;IAED,wDAAoB,GAApB;QACI,MAAM,CAAC,oDAA+B,EAAE,CAAC;IAC7C,CAAC;IAEM,wDAAoB,GAA3B;QACI,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IACrD,CAAC;IAWO,6CAAS,GAAjB,UAAkB,MAAkC;QAChD,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACT,IAAI,CAAC,UAAU,CAAC,cAAc,GAAG,MAAM,CAAC,eAAe,CAAC;YACxD,IAAI,CAAC,UAAU,CAAC,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC3F,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YAC1D,IAAI,CAAC,gBAAgB,GAAG,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;QAC7F,CAAC;IACL,CAAC;IAjDM,iCAAO,GAAa,CAAC,cAAc,EAAE,WAAW,EAAE,WAAW,EAAE,QAAQ,EAAE,eAAe,EAAE,MAAM,CAAC,CAAC;IAkD7G,gCAAC;CAAA,AAjED,IAiEC;AAjEY,8DAAyB","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {IComponentOptions, ILogService, IPromise} from 'angular';\nimport AuthServiceRS from '../../authentication/service/AuthServiceRS.rest';\nimport MitteilungRS from '../../core/service/mitteilungRS.rest';\nimport {getAemterForFilter, TSAmt} from '../../models/enums/TSAmt';\nimport {getTSMitteilungsStatusForFilter, TSMitteilungStatus} from '../../models/enums/TSMitteilungStatus';\nimport TSMitteilung from '../../models/TSMitteilung';\nimport TSMtteilungSearchresultDTO from '../../models/TSMitteilungSearchresultDTO';\nimport EbeguUtil from '../../utils/EbeguUtil';\nimport {TSRoleUtil} from '../../utils/TSRoleUtil';\nimport IStateService = angular.ui.IStateService;\nlet template = require('./posteingangView.html');\nrequire('./posteingangView.less');\n\nexport class PosteingangViewComponentConfig implements IComponentOptions {\n    transclude = false;\n    template = template;\n    controller = PosteingangViewController;\n    controllerAs = 'vm';\n}\n\nexport class PosteingangViewController {\n\n    displayedCollection: Array<TSMitteilung> = []; //Liste die im Gui angezeigt wird\n    pagination: any = {};\n    totalResultCount: string = '0';\n    myTableFilterState: any; // Muss hier gespeichert werden, damit es fuer den Aufruf ab \"Inkl.Erledigt\"-Checkbox vorhanden ist\n\n    itemsByPage: number = 20;\n    numberOfPages: number = 1;\n    selectedAmt: string;\n    selectedMitteilungsstatus: TSMitteilungStatus;\n    includeClosed: boolean;\n\n\n\n    static $inject: string[] = ['MitteilungRS', 'EbeguUtil', 'CONSTANTS', '$state', 'AuthServiceRS', '$log'];\n\n    constructor(private mitteilungRS: MitteilungRS, private ebeguUtil: EbeguUtil, private CONSTANTS: any, private $state: IStateService,\n                private authServiceRS: AuthServiceRS, private $log: ILogService) {\n    }\n\n    public addZerosToFallNummer(fallnummer: number): string {\n        return this.ebeguUtil.addZerosToNumber(fallnummer, this.CONSTANTS.FALLNUMMER_LENGTH);\n    }\n\n    private gotoMitteilung(mitteilung: TSMitteilung) {\n        this.$state.go('mitteilungen', {\n            fallId: mitteilung.fall.id\n        });\n    }\n\n    isCurrentUserSchulamt(): boolean {\n        let isUserSchulamt: boolean = this.authServiceRS.isOneOfRoles(TSRoleUtil.getSchulamtOnlyRoles());\n        return isUserSchulamt;\n    }\n\n    getAemter(): Array<TSAmt> {\n        return getAemterForFilter();\n    }\n\n    getMitteilungsStatus(): Array<TSMitteilungStatus> {\n        return getTSMitteilungsStatusForFilter();\n    }\n\n    public clickedIncludeClosed(): void {\n        this.passFilterToServer(this.myTableFilterState);\n    }\n\n    public passFilterToServer = (tableFilterState: any): IPromise<void> => {\n        this.pagination = tableFilterState.pagination;\n        this.myTableFilterState = tableFilterState;\n\n        return this.mitteilungRS.searchMitteilungen(tableFilterState, this.includeClosed).then((result: TSMtteilungSearchresultDTO) => {\n            this.setResult(result);\n        });\n    }\n\n    private setResult(result: TSMtteilungSearchresultDTO): void {\n        if (result) {\n            this.pagination.totalItemCount = result.totalResultSize;\n            this.pagination.numberOfPages = Math.ceil(result.totalResultSize / this.pagination.number);\n            this.displayedCollection = [].concat(result.mitteilungen);\n            this.totalResultCount = result.totalResultSize ? result.totalResultSize.toString() : '0';\n        }\n    }\n}\n"]}]}