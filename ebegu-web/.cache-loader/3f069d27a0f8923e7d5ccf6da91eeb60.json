{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/admin/component/testdatenView/testdatenView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/testdatenView/testdatenView.ts","mtime":1518535855204},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\ndefine([\"require\", \"exports\", \"../../../gesuch/dialog/OkDialogController\", \"../../../gesuch/dialog/LinkDialogController\"], function (require, exports, OkDialogController_1, LinkDialogController_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    require('./testdatenView.less');\n    var template = require('./testdatenView.html');\n    var okDialogTempl = require('../../../gesuch/dialog/okDialogTemplate.html');\n    var linkDialogTempl = require('../../../gesuch/dialog/linkDialogTemplate.html');\n    var TestdatenViewComponentConfig = /** @class */ (function () {\n        function TestdatenViewComponentConfig() {\n            this.transclude = false;\n            this.template = template;\n            this.controller = TestdatenViewController;\n            this.controllerAs = 'vm';\n        }\n        return TestdatenViewComponentConfig;\n    }());\n    exports.TestdatenViewComponentConfig = TestdatenViewComponentConfig;\n    var TestdatenViewController = /** @class */ (function () {\n        /* @ngInject */\n        function TestdatenViewController(testFaelleRS, dvDialog, userRS, errorService, reindexRS, gesuchsperiodeRS, databaseMigrationRS, zahlungRS, applicationPropertyRS, gesuchRS) {\n            this.dvDialog = dvDialog;\n            this.userRS = userRS;\n            this.errorService = errorService;\n            this.reindexRS = reindexRS;\n            this.gesuchsperiodeRS = gesuchsperiodeRS;\n            this.databaseMigrationRS = databaseMigrationRS;\n            this.zahlungRS = zahlungRS;\n            this.applicationPropertyRS = applicationPropertyRS;\n            this.gesuchRS = gesuchRS;\n            this.creationType = 'verfuegt';\n            this.testFaelleRS = testFaelleRS;\n        }\n        TestdatenViewController.prototype.$onInit = function () {\n            var _this = this;\n            this.userRS.getAllGesuchsteller().then(function (result) {\n                _this.gesuchstellerList = result;\n            });\n            this.gesuchsperiodeRS.getAllGesuchsperioden().then(function (result) {\n                _this.gesuchsperiodeList = result;\n            });\n            this.applicationPropertyRS.isDevMode().then(function (response) {\n                _this.devMode = response;\n            });\n        };\n        TestdatenViewController.prototype.createTestFallType = function (testFall) {\n            var bestaetigt = false;\n            var verfuegen = false;\n            if (this.creationType === 'warten') {\n                bestaetigt = false;\n                verfuegen = false;\n            }\n            else if (this.creationType === 'bestaetigt') {\n                bestaetigt = true;\n                verfuegen = false;\n            }\n            else if (this.creationType === 'verfuegt') {\n                bestaetigt = true;\n                verfuegen = true;\n            }\n            if (this.selectedBesitzer) {\n                return this.createTestFallGS(testFall, this.selectedGesuchsperiode.id, bestaetigt, verfuegen, this.selectedBesitzer.username);\n            }\n            else {\n                return this.createTestFall(testFall, this.selectedGesuchsperiode.id, bestaetigt, verfuegen);\n            }\n        };\n        TestdatenViewController.prototype.createTestFall = function (testFall, gesuchsperiodeId, bestaetigt, verfuegen) {\n            var _this = this;\n            return this.testFaelleRS.createTestFall(testFall, gesuchsperiodeId, bestaetigt, verfuegen).then(function (response) {\n                //einfach die letzten 36 zeichen der response als uuid betrachten, hacky ist aber nur fuer uns intern\n                var uuidPartOfString = response.data ? response.data.slice(-36) : '';\n                return _this.dvDialog.showDialog(linkDialogTempl, LinkDialogController_1.LinkDialogController, {\n                    title: response.data,\n                    link: '#/gesuch/fall/false///' + uuidPartOfString + '/',\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.createTestFallGS = function (testFall, gesuchsperiodeId, bestaetigt, verfuegen, username) {\n            var _this = this;\n            return this.testFaelleRS.createTestFallGS(testFall, gesuchsperiodeId, bestaetigt, verfuegen, username).then(function (response) {\n                //einfach die letzten 36 zeichen der response als uuid betrachten, hacky ist aber nur fuer uns intern\n                var uuidPartOfString = response.data ? response.data.slice(-36) : '';\n                return _this.dvDialog.showDialog(linkDialogTempl, LinkDialogController_1.LinkDialogController, {\n                    title: response.data,\n                    link: '#/gesuch/fall/false///' + uuidPartOfString + '/',\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.removeGesucheGS = function () {\n            var _this = this;\n            this.testFaelleRS.removeFaelleOfGS(this.selectedBesitzer.username).then(function () {\n                _this.errorService.addMesageAsInfo('Gesuche entfernt fuer ' + _this.selectedBesitzer.username);\n            });\n        };\n        TestdatenViewController.prototype.removeGesuchsperiode = function () {\n            var _this = this;\n            this.gesuchsperiodeRS.removeGesuchsperiode(this.selectedGesuchsperiode.id).then(function () {\n                _this.errorService.addMesageAsInfo('Gesuchsperiode entfernt ' + _this.selectedGesuchsperiode.gesuchsperiodeString);\n            });\n        };\n        TestdatenViewController.prototype.mutiereFallHeirat = function () {\n            var _this = this;\n            return this.testFaelleRS.mutiereFallHeirat(this.fallId, '0621fb5d-a187-5a91-abaf-8a813c4d263a', this.mutationsdatum, this.aenderungperHeirat).then(function (response) {\n                return _this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                    title: response.data\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.mutiereFallScheidung = function () {\n            var _this = this;\n            return this.testFaelleRS.mutiereFallScheidung(this.fallId, '0621fb5d-a187-5a91-abaf-8a813c4d263a', this.mutationsdatum, this.aenderungperScheidung).then(function (respone) {\n                return _this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                    title: respone.data\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.resetSchulungsdaten = function () {\n            var _this = this;\n            return this.testFaelleRS.resetSchulungsdaten().then(function (response) {\n                return _this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                    title: response.data\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.deleteSchulungsdaten = function () {\n            var _this = this;\n            return this.testFaelleRS.deleteSchulungsdaten().then(function (response) {\n                return _this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                    title: response.data\n                }).then(function () {\n                    //do nothing\n                });\n            });\n        };\n        TestdatenViewController.prototype.startReindex = function () {\n            return this.reindexRS.reindex();\n        };\n        TestdatenViewController.prototype.processScript = function (script) {\n            this.databaseMigrationRS.processScript(script);\n        };\n        TestdatenViewController.prototype.zahlungenKontrollieren = function () {\n            this.zahlungRS.zahlungenKontrollieren();\n        };\n        TestdatenViewController.prototype.deleteAllZahlungsauftraege = function () {\n            var _this = this;\n            this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                deleteText: 'ZAHLUNG_LOESCHEN_DIALOG_TEXT',\n                title: 'ZAHLUNG_LOESCHEN_DIALOG_TITLE',\n                parentController: undefined,\n                elementID: undefined\n            })\n                .then(function () {\n                _this.zahlungRS.deleteAllZahlungsauftraege();\n            });\n        };\n        TestdatenViewController.prototype.gesuchVerfuegen = function () {\n            var _this = this;\n            this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                deleteText: 'GESUCH_VERFUEGEN_DIALOG_TEXT',\n                title: 'GESUCH_VERFUEGEN_DIALOG_TITLE',\n                parentController: undefined,\n                elementID: undefined\n            })\n                .then(function () {\n                _this.gesuchRS.gesuchVerfuegen(_this.verfuegenGesuchid);\n            });\n        };\n        TestdatenViewController.$inject = ['TestFaelleRS', 'DvDialog', 'UserRS', 'ErrorService', 'ReindexRS', 'GesuchsperiodeRS',\n            'DatabaseMigrationRS', 'ZahlungRS', 'ApplicationPropertyRS', 'GesuchRS'];\n        return TestdatenViewController;\n    }());\n    exports.TestdatenViewController = TestdatenViewController;\n});\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/testdatenView/testdatenView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/admin/component/testdatenView/testdatenView.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {IComponentOptions, IPromise} from 'angular';\nimport {TestFaelleRS} from '../../service/testFaelleRS.rest';\nimport {DatabaseMigrationRS} from '../../service/databaseMigrationRS.rest';\nimport {DvDialog} from '../../../core/directive/dv-dialog/dv-dialog';\nimport {OkDialogController} from '../../../gesuch/dialog/OkDialogController';\nimport {LinkDialogController} from '../../../gesuch/dialog/LinkDialogController';\nimport TSUser from '../../../models/TSUser';\nimport UserRS from '../../../core/service/userRS.rest';\nimport ErrorService from '../../../core/errors/service/ErrorService';\nimport {ReindexRS} from '../../service/reindexRS.rest';\nimport * as moment from 'moment';\nimport TSGesuchsperiode from '../../../models/TSGesuchsperiode';\nimport GesuchsperiodeRS from '../../../core/service/gesuchsperiodeRS.rest';\nimport ZahlungRS from '../../../core/service/zahlungRS.rest';\nimport {ApplicationPropertyRS} from '../../service/applicationPropertyRS.rest';\nimport GesuchRS from '../../../gesuch/service/gesuchRS.rest';\n\nrequire('./testdatenView.less');\nlet template = require('./testdatenView.html');\nlet okDialogTempl = require('../../../gesuch/dialog/okDialogTemplate.html');\nlet linkDialogTempl = require('../../../gesuch/dialog/linkDialogTemplate.html');\n\nexport class TestdatenViewComponentConfig implements IComponentOptions {\n    transclude: boolean = false;\n    template: string = template;\n    controller: any = TestdatenViewController;\n    controllerAs: string = 'vm';\n}\n\nexport class TestdatenViewController {\n    static $inject = ['TestFaelleRS', 'DvDialog', 'UserRS', 'ErrorService', 'ReindexRS', 'GesuchsperiodeRS',\n        'DatabaseMigrationRS', 'ZahlungRS', 'ApplicationPropertyRS', 'GesuchRS'];\n\n    testFaelleRS: TestFaelleRS;\n    fallId: number;\n    verfuegenGesuchid: string;\n    mutationsdatum: moment.Moment;\n    aenderungperHeirat: moment.Moment;\n    aenderungperScheidung: moment.Moment;\n\n    creationType: string = 'verfuegt';\n    selectedBesitzer: TSUser;\n    gesuchstellerList: Array<TSUser>;\n\n    selectedGesuchsperiode: TSGesuchsperiode;\n    gesuchsperiodeList: Array<TSGesuchsperiode>;\n\n    devMode: boolean;\n\n    /* @ngInject */\n    constructor(testFaelleRS: TestFaelleRS, private dvDialog: DvDialog, private userRS: UserRS,\n                private errorService: ErrorService, private reindexRS: ReindexRS,\n                private gesuchsperiodeRS: GesuchsperiodeRS, private databaseMigrationRS: DatabaseMigrationRS,\n                private zahlungRS: ZahlungRS, private applicationPropertyRS: ApplicationPropertyRS,\n                private gesuchRS: GesuchRS) {\n        this.testFaelleRS = testFaelleRS;\n    }\n\n    $onInit() {\n        this.userRS.getAllGesuchsteller().then((result: Array<TSUser>) => {\n            this.gesuchstellerList = result;\n        });\n        this.gesuchsperiodeRS.getAllGesuchsperioden().then((result: Array<TSGesuchsperiode>) => {\n            this.gesuchsperiodeList = result;\n        });\n        this.applicationPropertyRS.isDevMode().then((response: boolean) => {\n            this.devMode = response;\n        });\n    }\n\n    public createTestFallType(testFall: string): IPromise<any> {\n        let bestaetigt: boolean = false;\n        let verfuegen: boolean = false;\n        if (this.creationType === 'warten') {\n            bestaetigt = false;\n            verfuegen = false;\n\n        } else if (this.creationType === 'bestaetigt') {\n            bestaetigt = true;\n            verfuegen = false;\n\n        } else if (this.creationType === 'verfuegt') {\n            bestaetigt = true;\n            verfuegen = true;\n        }\n        if (this.selectedBesitzer) {\n            return this.createTestFallGS(testFall, this.selectedGesuchsperiode.id, bestaetigt, verfuegen, this.selectedBesitzer.username);\n        } else {\n            return this.createTestFall(testFall, this.selectedGesuchsperiode.id, bestaetigt, verfuegen);\n        }\n    }\n\n    private createTestFall(testFall: string, gesuchsperiodeId: string, bestaetigt: boolean, verfuegen: boolean): IPromise<any> {\n        return this.testFaelleRS.createTestFall(testFall, gesuchsperiodeId, bestaetigt, verfuegen).then((response) => {\n            //einfach die letzten 36 zeichen der response als uuid betrachten, hacky ist aber nur fuer uns intern\n            let uuidPartOfString = response.data ? response.data.slice(-36) : '';\n            return this.dvDialog.showDialog(linkDialogTempl, LinkDialogController, {\n                title: response.data,\n                link: '#/gesuch/fall/false///' + uuidPartOfString + '/', //nicht alle Parameter werden benoetigt, deswegen sind sie leer\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    private createTestFallGS(testFall: string, gesuchsperiodeId: string, bestaetigt: boolean, verfuegen: boolean, username: string): IPromise<any> {\n        return this.testFaelleRS.createTestFallGS(testFall, gesuchsperiodeId, bestaetigt, verfuegen, username).then((response) => {\n            //einfach die letzten 36 zeichen der response als uuid betrachten, hacky ist aber nur fuer uns intern\n            let uuidPartOfString = response.data ? response.data.slice(-36) : '';\n            return this.dvDialog.showDialog(linkDialogTempl, LinkDialogController, {\n                title: response.data,\n                link: '#/gesuch/fall/false///' + uuidPartOfString + '/', //nicht alle Parameter werden benoetigt, deswegen sind sie leer\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    public removeGesucheGS() {\n        this.testFaelleRS.removeFaelleOfGS(this.selectedBesitzer.username).then(() => {\n            this.errorService.addMesageAsInfo('Gesuche entfernt fuer ' + this.selectedBesitzer.username);\n        });\n    }\n\n    public removeGesuchsperiode() {\n        this.gesuchsperiodeRS.removeGesuchsperiode(this.selectedGesuchsperiode.id).then(() => {\n            this.errorService.addMesageAsInfo('Gesuchsperiode entfernt ' + this.selectedGesuchsperiode.gesuchsperiodeString);\n        });\n    }\n\n    public mutiereFallHeirat(): IPromise<any> {\n        return this.testFaelleRS.mutiereFallHeirat(this.fallId, '0621fb5d-a187-5a91-abaf-8a813c4d263a',\n            this.mutationsdatum, this.aenderungperHeirat).then((response) => {\n            return this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n                title: response.data\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    public mutiereFallScheidung(): IPromise<any> {\n        return this.testFaelleRS.mutiereFallScheidung(this.fallId, '0621fb5d-a187-5a91-abaf-8a813c4d263a',\n            this.mutationsdatum, this.aenderungperScheidung).then((respone) => {\n            return this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n                title: respone.data\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    public resetSchulungsdaten(): IPromise<any> {\n        return this.testFaelleRS.resetSchulungsdaten().then((response) => {\n            return this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n                title: response.data\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    public deleteSchulungsdaten(): IPromise<any> {\n        return this.testFaelleRS.deleteSchulungsdaten().then((response) => {\n            return this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n                title: response.data\n            }).then(() => {\n                //do nothing\n            });\n        });\n    }\n\n    public startReindex() {\n        return this.reindexRS.reindex();\n    }\n\n    public processScript(script: string): void {\n        this.databaseMigrationRS.processScript(script);\n    }\n\n    public zahlungenKontrollieren(): void {\n        this.zahlungRS.zahlungenKontrollieren();\n    }\n\n    public deleteAllZahlungsauftraege(): void {\n        this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n            deleteText: 'ZAHLUNG_LOESCHEN_DIALOG_TEXT',\n            title: 'ZAHLUNG_LOESCHEN_DIALOG_TITLE',\n            parentController: undefined,\n            elementID: undefined\n        })\n            .then(() => {   //User confirmed removal\n                this.zahlungRS.deleteAllZahlungsauftraege();\n            });\n    }\n\n    public gesuchVerfuegen(): void {\n        this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n            deleteText: 'GESUCH_VERFUEGEN_DIALOG_TEXT',\n            title: 'GESUCH_VERFUEGEN_DIALOG_TITLE',\n            parentController: undefined,\n            elementID: undefined\n        })\n            .then(() => {   //User confirmed removal\n                this.gesuchRS.gesuchVerfuegen(this.verfuegenGesuchid);\n            });\n    }\n\n}\n"]}]}