{"remainingRequest":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js??ref--0-1!/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js??ref--0-2!/home/imanol/projects/ebegu/ebegu-web/src/admin/component/traegerschaftView/traegerschaftView.ts","cacheIdentifier":"cache-loader:1.1.0 test","dependencies":[{"path":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/traegerschaftView/traegerschaftView.ts","mtime":1512484411995},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/cache-loader/dist/cjs.js","mtime":1507514019000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/thread-loader/dist/cjs.js","mtime":1507523420000},{"path":"/home/imanol/projects/ebegu/ebegu-web/node_modules/ts-loader/index.js","mtime":1508488471000}],"contextDependencies":[],"result":["\"use strict\";\n/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./traegerschaftView.less\");\nvar TSTraegerschaft_1 = require(\"../../../models/TSTraegerschaft\");\nvar OkDialogController_1 = require(\"../../../gesuch/dialog/OkDialogController\");\nvar OkHtmlDialogController_1 = require(\"../../../gesuch/dialog/OkHtmlDialogController\");\nvar RemoveDialogController_1 = require(\"../../../gesuch/dialog/RemoveDialogController\");\nvar abstractAdminView_1 = require(\"../../abstractAdminView\");\nvar EbeguUtil_1 = require(\"../../../utils/EbeguUtil\");\nvar template = require('./traegerschaftView.html');\nvar style = require('./traegerschaftView.less');\nvar okDialogTempl = require('../../../gesuch/dialog/okDialogTemplate.html');\nvar okHtmlDialogTempl = require('../../../gesuch/dialog/okHtmlDialogTemplate.html');\nvar removeDialogTemplate = require('../../../gesuch/dialog/removeDialogTemplate.html');\nvar TraegerschaftViewComponentConfig = /** @class */ (function () {\n    function TraegerschaftViewComponentConfig() {\n        this.transclude = false;\n        this.bindings = {\n            traegerschaften: '<'\n        };\n        this.template = template;\n        this.controller = TraegerschaftViewController;\n        this.controllerAs = 'vm';\n    }\n    return TraegerschaftViewComponentConfig;\n}());\nexports.TraegerschaftViewComponentConfig = TraegerschaftViewComponentConfig;\nvar TraegerschaftViewController = /** @class */ (function (_super) {\n    __extends(TraegerschaftViewController, _super);\n    /* @ngInject */\n    function TraegerschaftViewController(TraegerschaftRS, errorService, dvDialog, authServiceRS, ebeguUtil) {\n        var _this = _super.call(this, authServiceRS) || this;\n        _this.errorService = errorService;\n        _this.dvDialog = dvDialog;\n        _this.ebeguUtil = ebeguUtil;\n        _this.traegerschaft = undefined;\n        _this.traegerschaftRS = TraegerschaftRS;\n        return _this;\n    }\n    TraegerschaftViewController.prototype.getTraegerschaftenList = function () {\n        return this.traegerschaften;\n    };\n    TraegerschaftViewController.prototype.removeTraegerschaft = function (traegerschaft) {\n        var _this = this;\n        this.dvDialog.showDialog(removeDialogTemplate, RemoveDialogController_1.RemoveDialogController, {\n            deleteText: '',\n            title: 'LOESCHEN_DIALOG_TITLE',\n            parentController: undefined,\n            elementID: undefined\n        })\n            .then(function () {\n            _this.traegerschaft = undefined;\n            _this.traegerschaftRS.removeTraegerschaft(traegerschaft.id).then(function (response) {\n                var index = EbeguUtil_1.default.getIndexOfElementwithID(traegerschaft, _this.traegerschaften);\n                if (index > -1) {\n                    _this.traegerschaften.splice(index, 1);\n                }\n            });\n        });\n    };\n    TraegerschaftViewController.prototype.createTraegerschaft = function () {\n        this.traegerschaft = new TSTraegerschaft_1.TSTraegerschaft();\n        this.traegerschaft.active = true;\n    };\n    TraegerschaftViewController.prototype.saveTraegerschaft = function (form) {\n        var _this = this;\n        if (form.$valid) {\n            this.errorService.clearAll();\n            var newTraegerschaft_1 = this.traegerschaft.isNew();\n            this.traegerschaftRS.createTraegerschaft(this.traegerschaft).then(function (traegerschaft) {\n                if (newTraegerschaft_1) {\n                    _this.traegerschaften.push(traegerschaft);\n                }\n                else {\n                    var index = EbeguUtil_1.default.getIndexOfElementwithID(traegerschaft, _this.traegerschaften);\n                    if (index > -1) {\n                        _this.traegerschaften[index] = traegerschaft;\n                        _this.ebeguUtil.handleSmarttablesUpdateBug(_this.traegerschaften);\n                    }\n                }\n                _this.traegerschaft = undefined;\n                if (!traegerschaft.synchronizedWithOpenIdm) {\n                    _this.dvDialog.showDialog(okDialogTempl, OkDialogController_1.OkDialogController, {\n                        title: 'TRAEGERSCHAFT_CREATE_SYNCHRONIZE'\n                    });\n                }\n            });\n        }\n    };\n    TraegerschaftViewController.prototype.cancelTraegerschaft = function () {\n        this.traegerschaft = undefined;\n    };\n    TraegerschaftViewController.prototype.setSelectedTraegerschaft = function (selected) {\n        this.traegerschaft = angular.copy(selected);\n    };\n    TraegerschaftViewController.prototype.syncWithOpenIdm = function () {\n        var _this = this;\n        this.traegerschaftRS.synchronizeTraegerschaften().then(function (respone) {\n            var returnString = respone.data.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n            return _this.dvDialog.showDialog(okHtmlDialogTempl, OkHtmlDialogController_1.OkHtmlDialogController, {\n                title: returnString\n            });\n        });\n    };\n    TraegerschaftViewController.$inject = ['TraegerschaftRS', 'ErrorService', 'DvDialog', 'AuthServiceRS', 'EbeguUtil'];\n    return TraegerschaftViewController;\n}(abstractAdminView_1.default));\nexports.TraegerschaftViewController = TraegerschaftViewController;\n",{"version":3,"file":"/home/imanol/projects/ebegu/ebegu-web/src/admin/component/traegerschaftView/traegerschaftView.ts","sourceRoot":"","sources":["/home/imanol/projects/ebegu/ebegu-web/src/admin/component/traegerschaftView/traegerschaftView.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Ki-Tax: System for the management of external childcare subsidies\n * Copyright (C) 2017 City of Bern Switzerland\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {IComponentOptions} from 'angular';\nimport './traegerschaftView.less';\nimport {TSTraegerschaft} from '../../../models/TSTraegerschaft';\nimport ErrorService from '../../../core/errors/service/ErrorService';\nimport {TraegerschaftRS} from '../../../core/service/traegerschaftRS.rest';\nimport {OkDialogController} from '../../../gesuch/dialog/OkDialogController';\nimport {DvDialog} from '../../../core/directive/dv-dialog/dv-dialog';\nimport {OkHtmlDialogController} from '../../../gesuch/dialog/OkHtmlDialogController';\nimport {RemoveDialogController} from '../../../gesuch/dialog/RemoveDialogController';\nimport AuthServiceRS from '../../../authentication/service/AuthServiceRS.rest';\nimport AbstractAdminViewController from '../../abstractAdminView';\nimport EbeguUtil from '../../../utils/EbeguUtil';\nimport IFormController = angular.IFormController;\n\nlet template = require('./traegerschaftView.html');\nlet style = require('./traegerschaftView.less');\nlet okDialogTempl = require('../../../gesuch/dialog/okDialogTemplate.html');\nlet okHtmlDialogTempl = require('../../../gesuch/dialog/okHtmlDialogTemplate.html');\nlet removeDialogTemplate = require('../../../gesuch/dialog/removeDialogTemplate.html');\n\nexport class TraegerschaftViewComponentConfig implements IComponentOptions {\n    transclude: boolean = false;\n    bindings: any = {\n        traegerschaften: '<'\n    };\n    template: string = template;\n    controller: any = TraegerschaftViewController;\n    controllerAs: string = 'vm';\n}\n\nexport class TraegerschaftViewController extends AbstractAdminViewController {\n\n    traegerschaftRS: TraegerschaftRS;\n    traegerschaften: TSTraegerschaft[];\n    traegerschaft: TSTraegerschaft = undefined;\n\n    static $inject = ['TraegerschaftRS', 'ErrorService', 'DvDialog', 'AuthServiceRS', 'EbeguUtil'];\n    /* @ngInject */\n    constructor(TraegerschaftRS: TraegerschaftRS, private errorService: ErrorService, private dvDialog: DvDialog,\n                authServiceRS: AuthServiceRS, private ebeguUtil: EbeguUtil) {\n        super(authServiceRS);\n        this.traegerschaftRS = TraegerschaftRS;\n    }\n\n    getTraegerschaftenList(): TSTraegerschaft[] {\n        return this.traegerschaften;\n    }\n\n    removeTraegerschaft(traegerschaft: any): void {\n        this.dvDialog.showDialog(removeDialogTemplate, RemoveDialogController, {\n            deleteText: '',\n            title: 'LOESCHEN_DIALOG_TITLE',\n            parentController: undefined,\n            elementID: undefined\n        })\n            .then(() => {   //User confirmed removal\n                this.traegerschaft = undefined;\n                this.traegerschaftRS.removeTraegerschaft(traegerschaft.id).then((response) => {\n                    let index = EbeguUtil.getIndexOfElementwithID(traegerschaft, this.traegerschaften);\n                    if (index > -1) {\n                        this.traegerschaften.splice(index, 1);\n                    }\n                });\n            });\n    }\n\n    createTraegerschaft(): void {\n        this.traegerschaft = new TSTraegerschaft();\n        this.traegerschaft.active = true;\n    }\n\n    saveTraegerschaft(form: IFormController): void {\n        if (form.$valid) {\n            this.errorService.clearAll();\n            let newTraegerschaft: boolean = this.traegerschaft.isNew();\n            this.traegerschaftRS.createTraegerschaft(this.traegerschaft).then((traegerschaft: TSTraegerschaft) => {\n                if (newTraegerschaft) {\n                    this.traegerschaften.push(traegerschaft);\n                } else {\n                    let index = EbeguUtil.getIndexOfElementwithID(traegerschaft, this.traegerschaften);\n                    if (index > -1) {\n                        this.traegerschaften[index] = traegerschaft;\n                        this.ebeguUtil.handleSmarttablesUpdateBug(this.traegerschaften);\n                    }\n                }\n                this.traegerschaft = undefined;\n                if (!traegerschaft.synchronizedWithOpenIdm) {\n                    this.dvDialog.showDialog(okDialogTempl, OkDialogController, {\n                        title: 'TRAEGERSCHAFT_CREATE_SYNCHRONIZE'\n                    });\n                }\n            });\n        }\n    }\n\n    cancelTraegerschaft(): void {\n        this.traegerschaft = undefined;\n    }\n\n    setSelectedTraegerschaft(selected: TSTraegerschaft): void {\n        this.traegerschaft = angular.copy(selected);\n    }\n\n    private syncWithOpenIdm(): void {\n        this.traegerschaftRS.synchronizeTraegerschaften().then((respone) => {\n            let returnString = respone.data.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n            return this.dvDialog.showDialog(okHtmlDialogTempl, OkHtmlDialogController, {\n                title: returnString\n            });\n        });\n    }\n}\n"]}]}