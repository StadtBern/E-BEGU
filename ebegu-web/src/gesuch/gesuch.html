<gesuch-toolbar flex="nogrow" gesuchid="{{vm.getGesuchId()}}"
                on-verantwortlicher-change="vm.setVerantwortlicher(user)"
                dv-show-element dv-show-allowed-roles="vm.TSRoleUtil.getAllRolesButGesuchsteller()">
</gesuch-toolbar>

<gesuch-toolbar-gesuchsteller flex="nogrow" class="gesuch-toolbar-gesuchsteller" gesuchid="{{vm.getGesuchId()}}"
                              fallid="{{vm.getGesuch().fall.id}}"
                              dv-show-element dv-show-allowed-roles="vm.TSRoleUtil.getGesuchstellerOnlyRoles()">
</gesuch-toolbar-gesuchsteller>
<!--Gesuchnavigation (Uebersicht)  fuer den Gesuchsteller (mobile)-->
<div class="mobile-sidenav-toggle mobile-open" flex="none" layout="row" layout-align="center center" dv-show-element
     dv-show-allowed-roles="vm.TSRoleUtil.getGesuchstellerOnlyRoles()" hide-gt-sm>
    <div class="mobile-active" flex layout="row" layout-align="start center" ng-click="vm.toggleSidenav('sidenav')">
        <span ng-bind="vm.getGesuchName()" class="gesuch-name"></span>
        <span ng-if="vm.isStepVisible('GESUCH_ERSTELLEN')" ng-bind="vm.getActiveElement() | translate"
              ng-class="{'active-element': !vm.isElementActive('GESUCH_ERSTELLEN')}">
        </span>
        <span ng-if="vm.isStepVisible('GESUCH_ERSTELLEN')"
              ui-sref-active="active"
              ng-class="{'active-element': vm.isElementActive('GESUCH_ERSTELLEN')}"
              ng-bind="vm.getGesuchErstellenStepTitle()">
        </span>
        <span class="fa fa-angle-down" aria-hidden="true"></span>
    </div>
</div>
<!--Gesuchnavigation (permanent offen wenn groesser als 600px)-->
<div layout="row" flex="auto" class="overflow-auto">
    <md-sidenav
        class="md-sidenav-left"
        id="sidenavContainer"
        md-component-id="sidenav"
        md-is-locked-open="$mdMedia('gt-sm')"
        md-whiteframe="4">
        <div class="mobile-sidenav-toggle mobile-close" hide-gt-sm>
            <button ng-click="vm.toggleSidenav('sidenav')" class="mobile-sidenav-close">
                <span class="fa fa-angle-left" aria-hidden="true"></span>
            </button>
        </div>
        <div class="mobile-sidenav-scroll">
            <div class="sidenav gesuch-status" ng-cloak>
                <span class="status" ng-bind="vm.getGesuchStatusTranslation()"></span>
                <br>
                <span class="zuletzt" data-translate="ZULETZT_BEARBEITER"
                      data-translate-value-username="{{vm.getUserFullname()}}"></span>
                <br>
                <span class="gesperrt" ng-if="vm.isGesuchGesperrt()"
                      data-translate="GESPERRT_WEGEN_BESCHWERDE"></span>
            </div>

            <ul class="sidenav gesuchMenu">

                <li ng-if="vm.isStepVisible('GESUCH_ERSTELLEN')"
                    ui-sref-active="active" class="row"
                    ng-class="{'active-element': vm.isElementActive('GESUCH_ERSTELLEN')}">

                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.fallcreation({createNew: false, gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('GESUCH_ERSTELLEN')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span ng-bind="vm.getGesuchErstellenStepTitle()"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('GESUCH_ERSTELLEN')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('FAMILIENSITUATION')"
                    class="row" ng-class="{'active-element': vm.isElementActive('FAMILIENSITUATION')}"
                    ui-sref-active="active" ng-disabled="vm.isWizardStepDisabled('FAMILIENSITUATION')">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.familiensituation({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('FAMILIENSITUATION')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_FAMSITUATION"></span>
                    </button>
                    <span class="col-xs-2 fa ng-class:vm.getIcon('FAMILIENSITUATION')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('GESUCHSTELLER')"
                    class="row" ng-class="{'active-element': vm.isElementActive('GESUCHSTELLER')}"
                    ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.stammdaten({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('GESUCHSTELLER')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_GESUCHSTELLER"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('GESUCHSTELLER')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('UMZUG')"
                    class="row" ng-class="{'active-element': vm.isElementActive('UMZUG')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.umzug({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('UMZUG')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_UMZUG"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('UMZUG')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('KINDER')"
                    class="row" ng-class="{'active-element': vm.isElementActive('KINDER')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.kinder({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('KINDER')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_KINDER"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('KINDER')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('BETREUUNG')"
                    class="row" ng-class="{'active-element': vm.isElementActive('BETREUUNG')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.betreuungen({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('BETREUUNG')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_BETREUUNG"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('BETREUUNG')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('ABWESENHEIT') && !vm.gesuchModelManager.isErstgesuch()"
                    class="row"
                    ng-class="{'active-element': vm.isElementActive('ABWESENHEIT')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.abwesenheit({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('ABWESENHEIT')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_ABWESENHEIT"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('ABWESENHEIT')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('ERWERBSPENSUM')"
                    class="row" ng-class="{'active-element': vm.isElementActive('ERWERBSPENSUM')}"
                    ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.erwerbsPensen({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('ERWERBSPENSUM')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_ERWERBSPENSUM"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('ERWERBSPENSUM')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('FINANZIELLE_SITUATION') && vm.showFinanzsituationStart()"
                    class="row" ng-class="{'active-element': vm.isElementActive('FINANZIELLE_SITUATION')}"
                    ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.finanzielleSituationStart({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('FINANZIELLE_SITUATION')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_FINANZIELLE_SITUATION"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('FINANZIELLE_SITUATION')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('FINANZIELLE_SITUATION') && !vm.showFinanzsituationStart()"
                    class="row" ng-class="{'active-element': vm.isElementActive('FINANZIELLE_SITUATION')}"
                    ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.finanzielleSituation({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('FINANZIELLE_SITUATION')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_FINANZIELLE_SITUATION"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('FINANZIELLE_SITUATION')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('EINKOMMENSVERSCHLECHTERUNG')"
                    class="row" ng-class="{'active-element': vm.isElementActive('EINKOMMENSVERSCHLECHTERUNG')}"
                    ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.einkommensverschlechterungInfo({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('EINKOMMENSVERSCHLECHTERUNG')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_EINKOMMENSVERSCHLECHTERUNG"></span>
                    </button>
                    <span class="col-xs-2 fa  ng-class:vm.getIcon('EINKOMMENSVERSCHLECHTERUNG')"
                          aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('DOKUMENTE')"
                    class="row" ng-class="{'active-element': vm.isElementActive('DOKUMENTE')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.dokumente({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('DOKUMENTE')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_DOKUMENTE"></span>
                    </button>
                    <span class="col-xs-2 fa ng-class:vm.getIcon('DOKUMENTE')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('FREIGABE')"
                    class="row" ng-class="{'active-element': vm.isElementActive('FREIGABE')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10  btn-link"
                            ui-sref="gesuch.freigabe({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('FREIGABE')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_FREIGABE"></span>
                    </button>
                    <span class="col-xs-2 fa ng-class:vm.getIcon('FREIGABE')" aria-hidden="true"></span>
                </li>

                <li ng-if="vm.isStepVisible('VERFUEGEN')"
                    class="row" ng-class="{'active-element': vm.isElementActive('VERFUEGEN')}" ui-sref-active="active">
                    <button type="button" class="col-xs-10 col-md-10  btn-link"
                            ui-sref="gesuch.verfuegen({gesuchId: vm.getGesuchId()})"
                            ng-disabled="vm.isWizardStepDisabled('VERFUEGEN')"
                            ng-click="vm.closeSidenav('sidenav')">
                        <span data-translate="MENU_VERFUEGEN"></span>
                    </button>
                    <span class="col-xs-2 fa  col-md-2 ng-class:vm.getIcon('VERFUEGEN')" aria-hidden="true"></span>
                </li>

            </ul>
        </div>
    </md-sidenav>


    <md-content id="gesuchContainer" flex>
        <!--linke Seite zum ausfüllen des Formulars-->
        <div ui-view="gesuchViewPort" autoscroll="true">
        </div>

    </md-content>
    <div id="kommentarContainer"
         dv-show-element
         dv-show-allowed-roles="vm.TSRoleUtil.getAllRolesForKommentarSpalte()" layout="column"
         layout-align="stretch center">
        <div ui-view="kommentarViewPort" flex="100"></div>
    </div>
</div>
